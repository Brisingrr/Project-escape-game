{% extends "layout.html.twig" %}

{% block title %}
    Accueil
{% endblock %}


{% block content %}

 <main class="container">
            
            <section class="row description">
                <div class="col-12 divDescription">
                    <h1 class="myEscapeGame">MyEscapeGame</h1>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                    tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                    quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                    consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                    cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                    proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                </div>
            </section><!-- .description -->

                <form class="row selection" method="POST" action="{{ path('json_search') }}">
                    <div class="col-md-6 divSelectVille">
                        <h3>Choisis ta ville : </h3>
                        <p>on mettra la sélection prédictive ici</p>
                        <form>
                            <input type="recherche" name="recherche" id="recherche">
                        </form>
                        <div id="listeVille"></div>
                        <script type="text/javascript">
                            $(function(){
                                    $('#recherche').on('keyup', rechercheVille);
                                });

                            function rechercheVille(e){
                                e.preventDefault();
                                var recherche = $('#recherche').val(),
                                    url = $(this).closest('form').attr('action');
                                $('#listeVille').html('');
                                $.ajax({
                                        url: url,
                                        type:'POST',
                                        data:'pays='+recherche
                            
                                    }).done(function(reponse){

                                        console.log(reponse);

                                        var json = $.parseJSON(reponse),
                                            result = json.result;

                                        console.log(json);

                                        if (json.status) {
                                            $.each(result, function(key, value){
                                                $('#listeVille').append('<p>'+value.ville+'</p>');
                                            });
                                        }
                                    });

                            }
                        </script>
                    </div>

                    <div class="col-md-6 divSelectCat">
                        <h3>Choisis ta catégorie : </h3>
                        <select>
                            {% for catego in categos %}
                        <option value='{{catego.id}}'>{{catego.nom}}</options>
                {% endfor %}
                        </select>
                    </div>
                    <div class="col-12">
                        <button class="btn-5">Envoyez</button>
                    </div>
                </form>

                
            <br>    
            <section class="row mapGoogle">
                <div class="col-12 divMap" id="map">
                    <!-- Ici s affiche la map -->
                    <img src="{{asset('imgs/maps.jpg')}}" alt="" width="100%" />
                </div>
            </section><!-- .mapGoogle -->
            <section class="row classement">
                <style type="text/css">
                .classement div{
                    display:flex;
                    margin-top: 25px;
                    margin-bottom: 25px;
                    margin-left: auto;
                    margin-right: auto;
                    padding-right: 10px;
                    
                }
                .classement figure{
                    border: 1px solid #c3c3c3;
                }
                .classement h2{
                    text-align: center;
                }

                </style>
                <div class="col-12" id="classement">
                    
                    <h3>Classement des 5 Meilleures Salles</h3>

                          
                    {% for result in slider %}
                    <div>
                        <figure>
                        <img src="{{asset('imgs/entreprise/')~result.id_entreprise~asset('/salles/')~result.image_salle}}" alt="salle"/>
                        <figcaption>
                            <h2>{{ result.nom }}</h2>
                        </figcaption>
                        </figure>
                    </div> 
                    {% endfor %}  
                </div>
            </section><!-- classement -->
        <!-- .main -->
    </main>
    {% if ajout is defined %}
        <div id="pop1" class="parentDisable">
            <div class="popin">
                <a class="close" href="#" onClick="return hide('pop1')"><i class="fa fa-times-circle" aria-hidden="true"></i></a>
                <h2 class="titrePop">Vous êtes bien inscrit !</h2>
            </div>
        </div>
    <script type="text/javascript">pop('pop1');</script>
    {% endif %}
      {% if connecter is defined %}
        <div id="pop1" class="parentDisable">
            <div class="popin">
                <a class="close" href="#" onClick="return hide('pop1')"><i class="fa fa-times-circle" aria-hidden="true"></i></a>
                <h2 class="titrePop">Vous êtes bien connecté !</h2>
            </div>
        </div>
    <script type="text/javascript">pop('pop1');</script>
    {% endif %}
{% endblock %}
